"use strict";(self["webpackChunksilverfish"]=self["webpackChunksilverfish"]||[]).push([[328],{3849:function(e,t,r){r.d(t,{Z:function(){return y}});var o=r(3396),n=r(6265),a=r.n(n),i=r(1474);function c(e,t,r,o,n,a,i){try{var c=e[a](i),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(o,n)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var a=e.apply(t,r);function i(e){c(a,o,n,i,s,"next",e)}function s(e){c(a,o,n,i,s,"throw",e)}i(void 0)}))}}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h="axios-retry";function _(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&i(e)}var f=["get","head","options"],m=f.concat(["put","delete"]);function v(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function p(e){return!!e.config&&(v(e)&&-1!==f.indexOf(e.config.method))}function E(e){return!!e.config&&(v(e)&&-1!==m.indexOf(e.config.method))}function C(e){return _(e)||E(e)}function g(){return 0}function R(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=100*Math.pow(2,e),r=.2*t*Math.random();return t+r}function D(e){var t=e[h]||{};return t.retryCount=t.retryCount||0,e[h]=t,t}function w(e,t){return u(u({},t),e[h])}function N(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}function b(e,t,r,o){return T.apply(this,arguments)}function T(){return T=s((function*(e,t,r,o){var n=r.retryCount<e&&t(o);if("object"===typeof n)try{return yield n,!0}catch(a){return!1}return n})),T.apply(this,arguments)}function I(e,t){e.interceptors.request.use((e=>{var t=D(e);return t.lastRequestTime=Date.now(),e})),e.interceptors.response.use(null,function(){var r=s((function*(r){var{config:o}=r;if(!o)return Promise.reject(r);var{retries:n=3,retryCondition:a=C,retryDelay:i=g,shouldResetTimeout:c=!1}=w(o,t),s=D(o);if(yield b(n,a,s,r)){s.retryCount+=1;var l=i(s.retryCount,r);if(N(e,o),!c&&o.timeout&&s.lastRequestTime){var u=Date.now()-s.lastRequestTime;o.timeout=Math.max(o.timeout-u-l,1)}return o.transformRequest=[e=>e],new Promise((t=>setTimeout((()=>t(e(o))),l)))}return Promise.reject(r)}));return function(e){return r.apply(this,arguments)}}())}I.isNetworkError=_,I.isSafeRequestError=p,I.isIdempotentRequestError=E,I.isNetworkOrIdempotentRequestError=C,I.exponentialDelay=R,I.isRetryableError=v;var O=r(4677);function y(){const e=(0,O.pm)(),t=(0,o.FN)()?.appContext.config.globalProperties.$endpoint,r=(0,o.FN)()?.appContext.config.globalProperties.$apiVersionRoute,n=`${t}${r}`,i=a().create({baseURL:`${n}/novels`}),c=a().create({baseURL:`${n}/comics`});function s(t){return new Promise(((r,o)=>i.get("",{headers:{Authorization:t}}).then((e=>e.data.success?r(e.data.data.map((e=>({...e,lastCrawlTime:new Date(e.lastCrawlTime)})))):o(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function l(t,r){return new Promise(((o,n)=>i.get(`/${r}`,{headers:{Authorization:t}}).then((e=>{if(e.data.success){const t=e.data.data;return o({isEnable:t.isEnable,novelID:t.novelID,author:t.author,description:t.description,dns:t.dns,url:t.url,title:t.title,cover_url:t.coverUrl,chapters:t.chapters,lastCrawlTime:new Date(t.lastCrawlTime)})}return n(e.data.data)})).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function u(t,r,o){return new Promise(((n,a)=>i.get(`/${r}/chapter/${o}`,{headers:{Authorization:t}}).then((e=>e.data.success?n(e.data.data):a(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function d(t){return new Promise(((r,o)=>c.get("",{headers:{Authorization:t}}).then((e=>e.data.success?r(e.data.data.map((e=>({...e,lastCrawlTime:new Date(e.lastCrawlTime)})))):o(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function h(t,r){return new Promise(((o,n)=>c.get(`/${r}`,{headers:{Authorization:t}}).then((e=>{if(e.data.success){const t=e.data.data;return o({comicID:t.comicID,author:t.author,description:t.description,dns:t.dns,url:t.url,title:t.title,cover_url:t.coverUrl,chapters:t.chapters,lastCrawlTime:new Date(t.lastCrawlTime)})}return n(e.data.data)})).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function _(t,r,o){return new Promise(((n,a)=>c.get(`/${r}/chapter/${o}`,{headers:{Authorization:t}}).then((e=>e.data.success?n(e.data.data):a(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}return I(i,{retries:3}),I(c,{retries:3}),{$endpointRoute:n,fetchNovels:s,fetchNovelByID:l,fetchNovelChapter:u,fetchComics:d,fetchComicByID:h,fetchComicChapter:_}}},1474:function(e){const t=new Set(["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED","HOSTNAME_MISMATCH"]);e.exports=e=>!t.has(e&&e.code)},6458:function(e,t,r){r.r(t),r.d(t,{default:function(){return V}});var o=r(3396),n=r(7139),a=r(9242);const i={class:"row"},c={class:"col-8 offset-2 col-md-8 offset-md-2"},s=(0,o._)("h5",null,"Novels",-1),l={class:"row"},u={class:"col col-4"},d=["href"],h=(0,o._)("br",null,null,-1),_={class:"col"},f={class:"input-group mb-3"},m=["disabled"],v=(0,o.Uk)(" Add "),p={class:"input-group mb-3"},E=["value"],C=["disabled"],g=(0,o.Uk)(" Delete "),R=(0,o._)("h5",null,"Comics",-1),D={class:"row"},w={class:"col col-4"},N=["href"],b=(0,o._)("br",null,null,-1),T={class:"col"},I={class:"input-group mb-3"},O=["disabled"],y=(0,o.Uk)(" Add "),A={class:"input-group mb-3"},U=["value"],L=["disabled"],P=(0,o.Uk)(" Delete ");function $(e,t,r,$,S,j){const F=(0,o.up)("font-awesome-icon");return(0,o.wg)(),(0,o.iD)("div",{id:"content",class:"container",style:(0,n.j5)({"min-height":`${e.withFootHeight}px`})},[(0,o._)("div",i,[(0,o._)("div",c,[s,(0,o._)("div",l,[(0,o._)("div",u,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.fetchers.novels,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e},[(0,o._)("a",{href:"http://"+e,target:"_blank"},(0,n.zw)(e),9,d),h])))),128))]),(0,o._)("div",_,[(0,o._)("div",f,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.addNovelUrl=t),class:"form-control"},null,512),[[a.nr,e.addNovelUrl]]),(0,o._)("button",{onClick:t[1]||(t[1]=(...t)=>e.addNovel&&e.addNovel(...t)),disabled:""===e.addNovelUrl,class:"btn-sm btn-color-1",type:"button"},[(0,o.Wm)(F,{icon:"arrow-circle-right"}),v],8,m)]),(0,o._)("div",p,[(0,o.wy)((0,o._)("select",{class:"form-control","onUpdate:modelValue":t[2]||(t[2]=t=>e.deleteNovelID=t)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.novels,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.novelID,value:e.novelID},(0,n.zw)(`${e.novelID} / ${e.title} / ${e.author}`),9,E)))),128))],512),[[a.bM,e.deleteNovelID]]),(0,o._)("button",{onClick:t[3]||(t[3]=(...t)=>e.deleteNovel&&e.deleteNovel(...t)),disabled:""===e.deleteNovelID,class:"btn-sm btn-color-1",type:"button"},[(0,o.Wm)(F,{icon:"arrow-circle-right"}),g],8,C)])])]),R,(0,o._)("div",D,[(0,o._)("div",w,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.fetchers.comics,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e},[(0,o._)("a",{href:"http://"+e,target:"_blank"},(0,n.zw)(e),9,N),b])))),128))]),(0,o._)("div",T,[(0,o._)("div",I,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[4]||(t[4]=t=>e.addComicUrl=t),class:"form-control"},null,512),[[a.nr,e.addComicUrl]]),(0,o._)("button",{onClick:t[5]||(t[5]=(...t)=>e.addComic&&e.addComic(...t)),disabled:""===e.addComicUrl,class:"btn-sm btn-color-1",type:"button"},[(0,o.Wm)(F,{icon:"arrow-circle-right"}),y],8,O)]),(0,o._)("div",A,[(0,o.wy)((0,o._)("select",{class:"form-control","onUpdate:modelValue":t[6]||(t[6]=t=>e.deleteComicID=t)},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.comics,(e=>((0,o.wg)(),(0,o.iD)("option",{key:e.comicID,value:e.comicID},(0,n.zw)(`${e.comicID} / ${e.title} / ${e.author}`),9,U)))),128))],512),[[a.bM,e.deleteComicID]]),(0,o._)("button",{onClick:t[7]||(t[7]=(...t)=>e.deleteComic&&e.deleteComic(...t)),disabled:""===e.deleteComicID,class:"btn-sm btn-color-1",type:"button"},[(0,o.Wm)(F,{icon:"arrow-circle-right"}),P],8,L)])])])])])],4)}var S=r(4870),j=r(4677),F=r(5410),k=r(6265),H=r.n(k),B=r(3849);function z(){const e=(0,j.pm)(),t=(0,o.FN)()?.appContext.config.globalProperties.$endpoint,{$endpointRoute:r}=(0,B.Z)(),n=H().create({baseURL:`${t}/admin`}),a=H().create({baseURL:`${r}/novels`}),i=H().create({baseURL:`${r}/comics`});function c(t){return new Promise(((r,o)=>n.get("/fetchers",{headers:{Authorization:t}}).then((e=>!0===e.data.success?r(e.data.data):o(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function s(t,r){return new Promise(((o,n)=>a.post("",(0,F.stringify)({novel_url:r}),{headers:{Authorization:t}}).then((e=>!0===e.data.success?o(e.data.data):n(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function l(t,r){return new Promise(((o,n)=>a.delete(`/${r}`,{headers:{Authorization:t}}).then((e=>!0===e.data.success?o(e.data.data):n(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function u(t,r){return new Promise(((o,n)=>i.post("",(0,F.stringify)({comic_url:r}),{headers:{Authorization:t}}).then((e=>!0===e.data.success?o(e.data.data):n(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}function d(t,r){return new Promise(((o,n)=>i.delete(`/${r}`,{headers:{Authorization:t}}).then((e=>!0===e.data.success?o(e.data.data):n(e.data.data))).catch((t=>e.error(`發生錯誤: ${t.toString()}`)))))}return{adminFetcherList:c,addNewNovel:s,deleteNovelByID:l,addNewComic:u,deleteComicByID:d}}var G=(0,o.aZ)({setup(){const e=(0,j.pm)(),{adminFetcherList:t,addNewComic:r,addNewNovel:n,deleteComicByID:a,deleteNovelByID:i}=z(),{fetchComics:c,fetchNovels:s}=(0,B.Z)(),l=(0,o.f3)("withFootHeight"),u=(0,o.f3)("session"),d=(0,S.qj)({novels:[],comics:[]}),h=(0,S.qj)([]),_=(0,S.qj)([]),f=(0,S.iH)(""),m=(0,S.iH)(""),v=(0,S.iH)(""),p=(0,S.iH)(""),E=async()=>{t(u.value).then((e=>{Object.assign(d.novels,e.fetchers.novels),Object.assign(d.comics,e.fetchers.comics)})),Object.assign(_,await s(u.value)),Object.assign(h,await c(u.value))},C=()=>{""!==f.value?n(u.value,f.value).then((t=>{e("添加成功！"),E(),console.log(t)})).catch((t=>{e.error("添加失敗!"),console.error(t)})):e.error("Novel URL不得為空.")},g=()=>{""!==m.value?i(u.value,m.value).then((t=>{e("刪除成功！"),E(),console.log(t)})).catch((t=>{e.error("刪除失敗!"),console.error(t)})):e.error("Novel ID不得為空.")},R=()=>{""!==v.value?r(u.value,v.value).then((t=>{e("添加成功！"),E(),console.log(t)})).catch((t=>{e.error("添加失敗!"),console.error(t)})):e.error("Comic URL不得為空.")},D=()=>{""!==p.value?a(u.value,p.value).then((t=>{e("刪除成功！"),E(),console.log(t)})).catch((t=>{e.error("刪除失敗!"),console.error(t)})):e.error("Comic ID不得為空.")};return(0,o.bv)((()=>E())),{withFootHeight:l,fetchers:d,comics:h,novels:_,addNovelUrl:f,deleteNovelID:m,addComicUrl:v,deleteComicID:p,addNovel:C,deleteNovel:g,addComic:R,deleteComic:D}}}),q=r(89);const x=(0,q.Z)(G,[["render",$]]);var V=x}}]);
//# sourceMappingURL=admin.c033b3c5.js.map