"use strict";(self["webpackChunksilverfish"]=self["webpackChunksilverfish"]||[]).push([[493],{114:function(e,t,i){i.r(t),i.d(t,{default:function(){return b}});var a=i(3396),n=i(7139);const l=e=>((0,a.dD)("data-v-4a625de6"),e=e(),(0,a.Cn)(),e),c={id:"article",class:"container"},o={key:0,class:"row"},u={class:"col-12"},r={id:"comic"},s=["src","alt"],v=l((()=>(0,a._)("br",null,null,-1))),d=l((()=>(0,a._)("br",null,null,-1)));function h(e,t,i,l,h,m){const g=(0,a.up)("reader-nav"),I=(0,a.up)("loading"),k=(0,a.up)("center"),p=(0,a.Q2)("observe-visibility");return(0,a.wg)(),(0,a.iD)("div",{id:"content",style:(0,n.j5)({"min-height":`${e.height}px`})},[(0,a._)("div",c,[0!==Object.keys(e.comic).length?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(g,{type:"comic",id:e.comicID,currentIndex:e.currentIndex,onChangeIndex:e.onChangeIndex,chapterLength:e.comic.chapters.length},null,8,["id","currentIndex","onChangeIndex","chapterLength"]),(0,a._)("div",u,[(0,a._)("div",r,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.sections,(t=>((0,a.wg)(),(0,a.iD)("div",{key:t.index},[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.content,(i=>((0,a.wg)(),(0,a.iD)("img",{key:i,referrerpolicy:"no-referrer",style:(0,n.j5)(e.getStyle(i)),src:i,alt:t.index.toString()},null,12,s)))),128)),(0,a.wy)((0,a._)("hr",null,null,512),[[p,{callback:(i,a)=>e.observe(i,a,t)}]])])))),128))]),(0,a._)("div",null,[v,d,(0,a.Wm)(k,null,{default:(0,a.w5)((()=>[(0,a.Wm)(I,{size:150})])),_:1})])])])):(0,a.kq)("",!0)])],4)}var m=i(4870),g=i(678),I=i(3196),k=i(3849),p=i(7885),x=(0,a.aZ)({components:{ReaderNav:p.Z},setup(){const e=(0,g.yj)(),t=(0,I.oR)(),{fetchComicByID:i,fetchComicChapter:n}=(0,k.Z)(),l=t.getters["auth/getSession"],c=(0,a.f3)("height"),o=(0,m.iH)(""),u=(0,m.iH)(!1),r=(0,m.iH)(!1),s=(0,m.qj)([]),v=(0,m.iH)(0),d=(0,m.iH)(1),h=(0,m.iH)(0),p=(0,a.Fl)((()=>t.getters["user/getComicBookmarkByID"](o.value)||{})),x=(0,a.Fl)((()=>t.getters["book/getComicByID"](o.value)||{})),y=async e=>{const t=await n(l,o.value,e);return{index:e,content:t}},D=async()=>{s.splice(0),v.value=d.value-1,h.value=d.value-1,await y(v.value).then((e=>s.push(e))),v.value+=1,await y(v.value).then((e=>s.push(e))),v.value+=1},b=async()=>{if(o.value=e.params.comicID,t.getters["book/isComicIDExists"](o.value)){const e=t.getters["book/getComicByID"](o.value);(void 0===e.chapters||t.getters["book/isComicNeedUpdate"](o.value))&&await i(l,o.value).then((e=>t.commit("book/updateComic",{comicID:o.value,comic:e}))),d.value=p.value.lastReadIndex||d.value}else await i(l,o.value).then((e=>t.commit("book/insertComic",{comicID:o.value,comic:e})));D()},C=e=>{d.value=e,D()},w=e=>e.endsWith("20%")?{width:"20%"}:{},f=(e,i,a)=>{e&&h.value<a.index&&(d.value=a.index+1,h.value=a.index,p.value.lastReadIndex=d.value,t.commit("user/insertComicBookmark",{comicID:x.value.comicID,bookmark:p.value}),!r.value&&v.value-d.value<1&&(r.value=!0,y(v.value).then((e=>s.push(e))),v.value+=1,setTimeout((()=>{r.value=!1}),1e3)))};return b(),{height:c,comicID:o,loading:r,lightOn:u,sections:s,fetchIndex:v,currentIndex:d,transitIndex:h,bookmark:p,comic:x,onChangeIndex:C,getStyle:w,observe:f}}}),y=i(89);const D=(0,y.Z)(x,[["render",h],["__scopeId","data-v-4a625de6"]]);var b=D}}]);
//# sourceMappingURL=comic.5d0540de.js.map