"use strict";(self["webpackChunksilverfish"]=self["webpackChunksilverfish"]||[]).push([[493],{56:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var i=a(3396),n=a(7139);const l=e=>((0,i.dD)("data-v-7ce59cca"),e=e(),(0,i.Cn)(),e),c={id:"article",class:"container"},o={key:0,class:"row"},u={class:"col-12"},s={id:"comic"},r=["src","alt"],v=l((()=>(0,i._)("br",null,null,-1))),d=l((()=>(0,i._)("br",null,null,-1)));function m(e,t,a,l,m,h){const g=(0,i.up)("reader-nav"),I=(0,i.up)("loading"),k=(0,i.up)("center"),p=(0,i.Q2)("observe-visibility");return(0,i.wg)(),(0,i.iD)("div",{id:"content",style:(0,n.j5)({"min-height":`${e.height}px`})},[(0,i._)("div",c,[0!==Object.keys(e.comic).length?((0,i.wg)(),(0,i.iD)("div",o,[(0,i.Wm)(g,{type:"comic",id:e.comicID,currentIndex:e.currentIndex,onChangeIndex:e.onChangeIndex,chapterLength:e.comic.chapters.length},null,8,["id","currentIndex","onChangeIndex","chapterLength"]),(0,i._)("div",u,[(0,i._)("div",s,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.sections,(t=>((0,i.wg)(),(0,i.iD)("div",{key:t.index},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.content,(a=>((0,i.wg)(),(0,i.iD)("img",{key:a,referrerpolicy:"no-referrer",style:(0,n.j5)(e.getStyle(a)),src:a,alt:t.index.toString()},null,12,r)))),128)),(0,i.wy)((0,i._)("hr",null,null,512),[[p,{callback:(a,i)=>e.observe(a,i,t)}]])])))),128))]),(0,i._)("div",null,[v,d,(0,i.Wm)(k,null,{default:(0,i.w5)((()=>[(0,i.Wm)(I,{size:150})])),_:1})])])])):(0,i.kq)("",!0)])],4)}var h=a(4870),g=a(678),I=a(3196),k=a(3849),p=a(7885),x=(0,i.aZ)({components:{ReaderNav:p.Z},setup(){const e=(0,g.yj)(),t=(0,I.oR)(),{fetchComicByID:a,fetchComicChapter:n}=(0,k.Z)(),l=(0,i.f3)("height"),c=(0,i.f3)("session"),o=(0,h.iH)(""),u=(0,h.iH)(!1),s=(0,h.iH)(!1),r=(0,h.qj)([]),v=(0,h.iH)(0),d=(0,h.iH)(1),m=(0,h.iH)(0),p=(0,i.Fl)((()=>t.getters["user/getComicBookmarkByID"](o.value)||{})),x=(0,i.Fl)((()=>t.getters["book/getComicByID"](o.value)||{})),y=async e=>{const t=await n(c.value,o.value,e);return{index:e,content:t}},b=async()=>{r.splice(0),v.value=d.value-1,m.value=d.value-1,await y(v.value).then((e=>r.push(e))),v.value+=1,await y(v.value).then((e=>r.push(e))),v.value+=1},D=async()=>{if(o.value=e.params.comicID,t.getters["book/isComicIDExists"](o.value)){const e=t.getters["book/getComicByID"](o.value);(void 0===e.chapters||t.getters["book/isComicNeedUpdate"](o.value))&&await a(c.value,o.value).then((e=>t.commit("book/updateComic",{comicID:o.value,comic:e}))),d.value=p.value.lastReadIndex||d.value}else await a(c.value,o.value).then((e=>t.commit("book/insertComic",{comicID:o.value,comic:e})));b()},C=e=>{d.value=e,b()},f=e=>e.endsWith("20%")?{width:"20%"}:{},w=(e,a,i)=>{e&&m.value<i.index&&(d.value=i.index+1,m.value=i.index,p.value.lastReadIndex=d.value,t.commit("user/insertComicBookmark",{comicID:x.value.comicID,bookmark:p.value}),!s.value&&v.value-d.value<1&&(s.value=!0,y(v.value).then((e=>r.push(e))),v.value+=1,setTimeout((()=>{s.value=!1}),1e3)))};return(0,i.bv)((()=>D())),{height:l,comicID:o,loading:s,lightOn:u,sections:r,fetchIndex:v,currentIndex:d,transitIndex:m,bookmark:p,comic:x,onChangeIndex:C,getStyle:f,observe:w}}}),y=a(89);const b=(0,y.Z)(x,[["render",m],["__scopeId","data-v-7ce59cca"]]);var D=b}}]);
//# sourceMappingURL=comic.d894ac30.js.map