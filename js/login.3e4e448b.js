"use strict";(self["webpackChunksilverfish"]=self["webpackChunksilverfish"]||[]).push([[535],{7676:function(e,t,n){n.d(t,{Z:function(){return u}});n(1703);var o=n(3396),a=n(4870);function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},r.apply(this,arguments)}var i=function(){var e=!1,t=[],n=function(){if(!e){e=!0;for(var n=0,o=t.length;n<o;n++)t[n]()}},o=function(n){e?n():t.push(n)},a={resolved:function(){return e},resolve:n,promise:{then:o}};return a},c=Object.prototype.hasOwnProperty;function l(){var e=i();return{notify:function(){e.resolve()},wait:function(){return e.promise},render:function(e,t,n){this.wait().then((function(){n(window.grecaptcha.render(e,t))}))},reset:function(e){"undefined"!==typeof e&&(this.assertLoaded(),this.wait().then((function(){return window.grecaptcha.reset(e)})))},execute:function(e){"undefined"!==typeof e&&(this.assertLoaded(),this.wait().then((function(){return window.grecaptcha.execute(e)})))},checkRecaptchaLoad:function(){c.call(window,"grecaptcha")&&c.call(window.grecaptcha,"render")&&this.notify()},assertLoaded:function(){if(!e.resolved())throw new Error("ReCAPTCHA has not been loaded")}}}var s=l();"undefined"!==typeof window&&(window.vueRecaptchaApiLoaded=s.notify);var u=(0,o.aZ)({name:"VueRecaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String},badge:{type:String},type:{type:String},size:{type:String},tabindex:{type:String},loadRecaptchaScript:{type:Boolean,default:!0},recaptchaScriptId:{type:String,default:"__RECAPTCHA_SCRIPT"},recaptchaHost:{type:String,default:"www.google.com"},language:{type:String,default:""}},emits:["render","verify","expired","error"],setup:function(e,t){var n=t.slots,i=t.emit,c=(0,a.iH)(null),l=(0,a.iH)(null),u=function(e){i("verify",e)},d=function(){i("expired")},p=function(){i("error")};return(0,o.bv)((function(){if(s.checkRecaptchaLoad(),e.loadRecaptchaScript&&!document.getElementById(e.recaptchaScriptId)){var t=document.createElement("script");t.id=e.recaptchaScriptId,t.src="https://"+e.recaptchaHost+"/recaptcha/api.js?onload=vueRecaptchaApiLoaded&render=explicit&hl="+e.language,t.async=!0,t.defer=!0,document.head.appendChild(t)}var o=r({},e,{callback:u,"expired-callback":d,"error-callback":p}),a=c.value,h=n["default"]?a.children[0]:a;s.render(h,o,(function(e){l.value=e,i("render",e)}))})),{root:c,widgetId:l,reset:function(){s.reset(l.value)},execute:function(){s.execute(l.value)}}},render:function(){var e,t=this.$slots["default"];return e="function"===typeof t?t():t,(0,o.h)("div",{ref:"root"},e)}})},8439:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var o=n(3396),a=n(7139),r=n(9242);const i=e=>((0,o.dD)("data-v-e6f1cd60"),e=e(),(0,o.Cn)(),e),c={class:"row"},l={id:"form",class:"col-8 offset-2 col-md-4 offset-md-4"},s={class:"input-group mb-3"},u={key:0,class:"input-group-append"},d={class:"input-group mb-3"},p={key:0,class:"input-group-append"},h={class:"form-group",style:{"text-align":"right"}},f={key:0},g={class:"row justify-content-around"},v={class:"col-2",style:{"text-align":"left"}},w=["disabled"],y={class:"col-8",title:"保持連續一周的登入狀態"},m={class:"form-check form-switch form-check-inline"},b=i((()=>(0,o._)("small",{class:"form-check-label",for:"keepLogin"}," 保持登入? ",-1))),k={class:"row"},_={class:"col align-self-end",style:{"text-align":"right"}},x=["onClick","onKeypress"],R=(0,o.Uk)("   "),S=i((()=>(0,o._)("small",{title:"關我屁事"},"忘記密碼?",-1))),L={key:1},A=i((()=>(0,o._)("br",null,null,-1)));function C(e,t,n,i,C,H){const j=(0,o.up)("font-awesome-icon"),V=(0,o.up)("vue-recaptcha"),E=(0,o.up)("router-link"),P=(0,o.up)("loading"),q=(0,o.up)("center");return(0,o.wg)(),(0,o.iD)("div",{id:"content",class:"container",style:(0,a.j5)({"min-height":`${e.withFootHeight}px`})},[(0,o._)("div",c,[(0,o._)("div",l,[(0,o._)("form",null,[(0,o._)("div",s,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=t=>e.auth.account=t),class:"form-control",type:"text",placeholder:"帳號",required:""},null,512),[[r.nr,e.auth.account]]),e.auth.account.length>0?((0,o.wg)(),(0,o.iD)("div",u,[(0,o._)("button",{class:"btn btn-light",type:"button",tabindex:"-1",onClick:t[1]||(t[1]=t=>e.auth.account="")},[(0,o.Wm)(j,{icon:["far","times-circle"]})])])):(0,o.kq)("",!0)]),(0,o._)("div",d,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[2]||(t[2]=t=>e.auth.password=t),class:"form-control",type:"password",placeholder:"密碼",required:""},null,512),[[r.nr,e.auth.password]]),e.auth.password.length>0?((0,o.wg)(),(0,o.iD)("div",p,[(0,o._)("button",{class:"btn btn-light",type:"button",tabindex:"-1",onClick:t[3]||(t[3]=t=>e.auth.password="")},[(0,o.Wm)(j,{icon:["far","times-circle"]})])])):(0,o.kq)("",!0)]),(0,o._)("div",h,[(0,o.Wm)(V,{ref:"invisibleRecaptcha",size:"invisible",onVerify:e.onRecaptchaVerfiy,onExpired:e.onRecaptchaExpired,loadRecaptchaScript:!0,sitekey:"6LdgzKYUAAAAAG8KH1AHc_Xjj7yVcAYXZFj7PsPH"},null,8,["onVerify","onExpired"]),!1===e.load?((0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("div",g,[(0,o._)("div",v,[(0,o._)("input",{class:"btn-sm btn-color-2",type:"button",value:"登入",onClick:t[4]||(t[4]=t=>e.submitLogin()),disabled:e.valid()},null,8,w)]),(0,o._)("div",y,[(0,o._)("div",m,[(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[5]||(t[5]=t=>e.auth.keepLogin=t),class:"form-check-input",type:"checkbox",id:"keepLogin"},null,512),[[r.e8,e.auth.keepLogin]]),b])])]),(0,o._)("div",k,[(0,o._)("div",_,[(0,o.Wm)(E,{to:{name:"register"},custom:""},{default:(0,o.w5)((({navigate:e})=>[(0,o._)("small",{onClick:e,onKeypress:e},"註冊",40,x)])),_:1}),R,S])])])):((0,o.wg)(),(0,o.iD)("div",L,[A,(0,o.Wm)(q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(P,{size:80})])),_:1})]))])])])])],4)}var H=n(4870),j=n(7676),V=n(3196),E=n(2417),P=n(678),q=n(4677),I=(0,o.aZ)({components:{VueRecaptcha:j.Z},setup(){const e=(0,q.pm)(),t=(0,V.oR)(),n=(0,P.tv)(),a=(0,P.yj)(),{authLogin:r}=(0,E.Z)(),i=(0,o.f3)("withFootHeight"),{redirect:c}=a.query,l=t.getters["auth/getSession"],s=(0,H.iH)(!1),u=(0,H.qj)({keepLogin:!1,account:"",password:""}),d=(0,H.iH)(null),p=()=>""===u.account||""===u.password,h=()=>{s.value=!0,d.value.execute()},f=()=>d.value.reset(),g=o=>{r(l,o,u).then((o=>{t.dispatch("auth/login",o),e("登入成功"),n.push(void 0!==c?{path:c}:{name:"list"})})).catch((t=>{"Recaptcha verify failed"===t.reason?e.error("Google Recaptch 驗證失敗！"):"Account or Password wrong"===t.reason?e.error("帳號或密碼錯誤！"):"Account not exists"===t.reason?e.error("帳號不存在！"):(e.error("未知錯誤！"),console.error(t)),f(),s.value=!1}))};return(0,o.bv)((()=>{"https:"!==window.location.protocol&&(window.location.href=`https:${window.location.href.substring(window.location.protocol.length)}`)})),{withFootHeight:i,load:s,auth:u,invisibleRecaptcha:d,valid:p,submitLogin:h,onRecaptchaExpired:f,onRecaptchaVerfiy:g}}}),Z=n(89);const D=(0,Z.Z)(I,[["render",C],["__scopeId","data-v-e6f1cd60"]]);var W=D}}]);
//# sourceMappingURL=login.3e4e448b.js.map